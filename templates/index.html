<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Chat Web (Cliente Simples)</title>
    <style>body{font-family:sans-serif;max-width:800px;margin:auto;padding:1rem}#messages{border:1px solid #ccc;padding:1rem;height:300px;overflow-y:scroll;margin-bottom:1rem}input{width:80%;padding:.5rem}button{width:18%;padding:.5rem}</style>
</head>
<body>
    <h1>Chat via Navegador</h1>
    <p><b>Aviso:</b> Este cliente web cumpre o requisito de ser acessível via navegador, mas devido a limitações do JavaScript, ele não usa uma thread dedicada para recepção como o cliente de terminal.</p>
    <div id="messages"></div>
    <input type="text" id="username" placeholder="Digite seu nome e pressione Enter">
    <input type="text" id="messageInput" placeholder="Digite sua mensagem..." disabled>
    <button id="sendButton" disabled>Enviar</button>
    <script>
        const messages = document.getElementById('messages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const usernameInput = document.getElementById('username');
        let username = '';
        
        // O cliente web precisa se conectar diretamente ao proxy via WebSocket
        // Nota: Esta parte é conceitual, pois nosso proxy TCP não fala WebSocket.
        // Para fazer este cliente web funcionar, o proxy precisaria ser um proxy HTTP/WebSocket como Nginx.
        // Apresentamos o código para demonstrar como seria.
        
        usernameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && usernameInput.value) {
                username = usernameInput.value;
                usernameInput.disabled = true;
                messageInput.disabled = false;
                sendButton.disabled = false;
                messages.innerHTML += `<div><i>Você entrou como ${username}. (Conexão WebSocket não implementada neste proxy)</i></div>`;
            }
        });

        sendButton.addEventListener('click', () => {
            if (messageInput.value && username) {
                const message = `${username}: ${messageInput.value}`;
                // ws.send(message);
                messages.innerHTML += `<div><b>${username}</b>: ${messageInput.value}</div>`;
                messageInput.value = '';
            }
        });
    </script>
</body>
</html>